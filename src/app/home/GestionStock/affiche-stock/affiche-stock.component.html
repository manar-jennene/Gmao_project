<app-header></app-header>
<app-sidebar></app-sidebar>

<main class="dashboard-container">
  <!-- Section opÃ©rations -->
  <section class="card card-ops">
    <h2>âš™ï¸ Mes opÃ©rations</h2>
    <div class="ops-grid">
      <button class="btn-primary" routerLink="/home/demandestock">Demande de Stock</button>
      <button class="btn-primary" routerLink="/home/listestock">Ajouter Stock</button>
      <button class="btn-primary" routerLink="/home/historique">Historique de Stock</button>
      <button class="btn-primary" routerLink="/home/mouvement">Mouvement de Stock</button>
    </div>
  </section>

  <!-- Section alerte produit -->
  <section class="card card-alert">
    <h2>ğŸš¨ Produits en alerte</h2>
    <table>
      <thead>
        <tr>
          <th>RÃ©fÃ©rence</th>
          <th>Nom</th>
          <th>Seuil Minimum</th>
          <th>QuantitÃ© Disponible</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of produitsAlertes">
          <td>{{ item.reference }}</td>
          <td>{{ item.nom }}</td>
          <td>{{ item.seuil_minimum }}</td>
          <td>{{ item.quantite_disponible }}</td>
        </tr>
        <tr *ngIf="!produitsAlertes || produitsAlertes.length === 0">
          <td colspan="4" style="text-align:center; color:#888;">Aucun produit en alerte</td>
        </tr>
      </tbody>
    </table>
  </section>

  <!-- Section IA + Statistiques -->
  <div class="ia-stats-row">
    <section class="card card-ia">
      <h2>ğŸ¤– Alerte IA</h2>
      <p *ngIf="alertMessage">âš  {{ alertMessage }}</p>
      <p *ngIf="!alertMessage">Aucune alerte dÃ©tectÃ©e pour les prochains jours.</p>
      <button class="btn-danger" (click)="toggleIA()">
        {{ showIA ? "Masquer dÃ©tails IA" : "Voir dÃ©tails IA" }}
      </button>
    </section>

    <section class="card stats-card">
      <h3>ğŸ“Š Statistiques</h3>
      <p><strong>Valeur minimale prÃ©vue :</strong> {{ minPrediction | number:'1.2-2' }}</p>
      <p><strong>Nombre de jours analysÃ©s :</strong> {{ predictions.length }}</p>
    </section>
  </div>

  <!-- Section graphique -->
  <section class="card chart-card">
    <h3>ğŸ“ˆ Graphique de prÃ©diction</h3>
    <canvas id="predictionChart"></canvas>
  </section>

  <!-- Section tableau -->
  <section class="card table-card">
    <h3>ğŸ“… DÃ©tails des prÃ©dictions</h3>
    <table>
      <thead>
        <tr>
          <th>Date</th>
          <th>PrÃ©vision Stock</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let pred of predictions">
          <td>{{ pred.ds }}</td>
          <td>{{ pred.yhat | number:'1.2-2' }}</td>
        </tr>
      </tbody>
    </table>
  </section>
</main>
